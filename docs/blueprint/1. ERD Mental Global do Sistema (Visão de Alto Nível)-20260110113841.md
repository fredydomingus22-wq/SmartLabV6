# 1. ERD Mental Global do Sistema (Visão de Alto Nível)

## **1.1. Objetivo do Ecossistema**
Estabelecer uma camada única de verdade para **Produção, Qualidade, Laboratório e Segurança Alimentar**, garantindo rastreabilidade de lotes, evidência para auditorias e capacidade de intervenção da Qualidade sobre a Produção em tempo quase real.
## **1.2. Entidades Transversais**
*   **Empresa**
*   **UnidadeIndustrial** (fábrica)
*   **LinhaProducao** / **Equipamento**
*   **Produto** (acabado, semi-acabado, intermédio)
*   **Receita** / **Formulação**
*   **LoteMateriaPrima**
*   **Fornecedor**
*   **LoteProducao** (lote acabado)
*   **OrdemProducao**
*   **PlanoAmostragem** (por produto/linha/PCC)
*   **Amostra** (processo, produto acabado, matéria-prima, ambiente)
*   **EnsaioLaboratorial** (microbiologia, físico‑química)
*   **ResultadoEnsaio**
*   **PlanoHACCP**
*   **PCC** (Ponto Crítico de Controlo)
*   **MonitorizacaoPCC** (registos de controlo PCC)
*   **NaoConformidade**
*   **CAPA** (ação corretiva e preventiva)
*   **Auditoria** (interna/externa)
*   **Usuario** / **PerfilAcesso** / **Permissao**
*   **AuditLog** (trilha de auditoria de sistema)
## **1.3. Relações Globais-Chave**
*   **UnidadeIndustrial** possui várias **LinhaProducao**.
*   **Produto** referencia **Receita** e pode ser produzido em várias **LinhaProducao**.
*   **OrdemProducao** gera um ou mais **LoteProducao**.
*   Cada **LoteProducao** consome múltiplos **LoteMateriaPrima** (por **Fornecedor**).
*   **PlanoHACCP** define múltiplos **PCC** por produto/linha.
*   Cada **PCC** possui um **PlanoAmostragem** e parâmetros críticos.
*   **Amostra** referencia **LoteProducao** ou **LoteMateriaPrima** ou **Ponto de Processo**.
*   **Amostra** gera um ou mais **EnsaioLaboratorial**, que geram **ResultadoEnsaio**.
*   **MonitorizacaoPCC** referencia **PCC**, **LinhaProducao**, **Turno**, **LoteProducao**.
*   **ResultadoEnsaio** e **MonitorizacaoPCC** podem originar **NaoConformidade**.
*   **NaoConformidade** pode gerar uma ou mais **CAPA**.
*   **Auditoria** referencia **NaoConformidade**, **CAPA** e evidências de **MonitorizacaoPCC** e **ResultadosLaboratoriais**.
## **1.4. Eventos Críticos Globais**
*   Criação de **OrdemProducao** e abertura de **LoteProducao**.
*   Registo de **MonitorizacaoPCC** (dentro/fora de especificação).
*   Registo de **Amostra** e conclusão de **ResultadoEnsaio** (aprovado/reprovado).
*   Geração de **NaoConformidade** e respetiva **CAPA**.
*   Decisão de **bloqueio/liberação de lote** (Qualidade comanda Produção).
*   Fecho de **Auditoria** (interna/externa) com evidências documentadas.

* * *

# **2\. ERD Mental por Módulo + Lógica de Backend**
## **2.1. Módulo MES – Execução da Produção**
### **Objetivo**
Controlar ordens de produção, lotes, linhas, estados de execução e ligação direta à Qualidade/FSMS.
### **Entidades Principais**
*   **OrdemProducao** (ID, produto, quantidade planeada, data/hora planeada, estado)
*   **LoteProducao** (ID lote, produto, quantidade real, datas início/fim, estado qualidade)
*   **LinhaProducao** (linha, capacidade, estado operacional)
*   **Turno** (turno, responsável, equipa)
*   **EventoProducao** (paragem, reinício, ajuste, sucata)
### **Relações**
*   Uma **OrdemProducao** gera um ou vários **LoteProducao**.
*   **LoteProducao** é produzido numa **LinhaProducao** e num **Turno**.
*   **EventoProducao** referencia **LoteProducao** e **LinhaProducao**.
### **Eventos Críticos**
*   Planeamento de **OrdemProducao**.
*   Abertura de **LoteProducao** (inicio real).
*   Encerramento de **LoteProducao** (fim real, yield, refugos).
*   Registo de **EventoProducao** (paragens críticas, sucata acima do normal).
### **Lógica de Backend (conceitual)**
*   Transição de estado de **OrdemProducao**: Planeada → EmExecucao → Concluida/Cancelada.
*   Na abertura de **LoteProducao**, o backend:
    *   instancia registos de rastreabilidade (ligação a matérias-primas e linhas);
    *   cria "ganchos" para **PlanoAmostragem** (MES → LIMS/FSMS).
*   Na conclusão de **LoteProducao**, o backend bloqueia o lote até decisão da **Qualidade** (integração com QMS/FSMS).

* * *

## **2.2. Módulo LIMS – Laboratório (Microbiologia e Físico‑Química)**
### **Objetivo**
Garantir gestão rastreável de amostras, ensaios, resultados e laudos, com conformidade a **ISO 17025** e integração direta com MES/FSMS.
### **Entidades Principais**
*   **Amostra** (tipo, origem, produto/lote, data/hora, estado)
*   **PlanoAmostragem** (produto, PCC, frequência, tamanho de amostra)
*   **EnsaioLaboratorial** (tipo de ensaio, método, norma, tempo de incubação)
*   **ResultadoEnsaio** (valor medido, unidade, limite, conformidade)
*   **Laudo** (consolidação de resultados por amostra/lote)
### **Relações**
*   **PlanoAmostragem** gera **Amostras** de forma programada ou disparada por evento.
*   Cada **Amostra** gera um ou mais **EnsaioLaboratorial**.
*   Cada **EnsaioLaboratorial** gera um **ResultadoEnsaio**.
*   **Laudo** consolida **ResultadoEnsaio** por **Amostra** / **LoteProducao**.
### **Eventos Críticos**
*   Criação de **Amostra** associada a **LoteProducao**.
*   Validação de **ResultadoEnsaio** (aprovação/reprovação).
*   Emissão de **Laudo** com decisão de liberação/bloqueio.
### **Lógica de Backend (conceitual)**
*   Geração automática de **Amostras** com base em **PlanoAmostragem** e eventos do MES.
*   Estados de **Amostra**: AguardandoColeta → EmAnalise → Concluida → Cancelada.
*   Estados de **ResultadoEnsaio**: Provisório → ValidadoLaboratorio → ValidadoQualidade.
*   Regras de integridade:
    *   não permitir emissão de **Laudo** sem todos os **ResultadoEnsaio** obrigatórios;
    *   bloqueio automático de **LoteProducao** quando resultados fora de especificação.

* * *

## **2.3. Módulo QMS – Gestão da Qualidade**
### **Objetivo**
Gerir **não conformidades**, **CAPA**, desvios e auditorias, garantindo fechamento de ciclo e evidência documental.
### **Entidades Principais**
*   **NaoConformidade** (tipo, origem, criticidade, estado)
*   **DesvioProcesso** (associado a lote, linha, PCC ou resultado laboratorial)
*   **CAPA** (planos de ação, responsável, prazos, eficácia)
*   **Auditoria** (internas, externas, cliente, certificadora)
### **Relações**
*   **DesvioProcesso** pode originar uma ou mais **NaoConformidade**.
*   Cada **NaoConformidade** possui zero ou mais **CAPA**.
*   **Auditoria** referencia múltiplas **NaoConformidade** e CAPA.
### **Eventos Críticos**
*   Abertura de **NaoConformidade** crítica.
*   Implementação e verificação de eficácia de **CAPA**.
*   Fecho de **Auditoria** com evidências de NC/CAPA.
### **Lógica de Backend (conceitual)**
*   Workflow de **NaoConformidade**: Aberta → EmInvestigacao → EmTratamento → Encerrada.
*   Workflow de **CAPA**: Planeada → EmExecucao → EmVerificacaoEficacia → Encerrada.
*   Gatilhos automáticos de abertura de NC a partir de:
    *   resultados fora de especificação (LIMS);
    *   PCC fora de controlo (FSMS);
    *   desvios registados no MES.

* * *

## **2.4. Módulo FSMS – Segurança Alimentar (HACCP/BPF/ISO 22000)**
### **Objetivo**
Formalizar e operacionalizar o plano HACCP, controlo de PCC, BPF e pré‑requisitos, garantindo evidência contínua para auditorias.
### **Entidades Principais**
*   **PlanoHACCP** (por unidade/produto/linha)
*   **PCC** (parâmetros críticos, limites, ações corretivas)
*   **MonitorizacaoPCC** (registos de controlo)
*   **ChecklistBPF** (inspeções de BPF, pré‑requisitos)
### **Relações**
*   Um **PlanoHACCP** possui vários **PCC**.
*   Cada **PCC** possui parâmetros críticos e integra **MonitorizacaoPCC**.
*   **MonitorizacaoPCC** pode originar **NaoConformidade**.
### **Eventos Críticos**
*   Definição/atualização de **PlanoHACCP**.
*   Registo de **MonitorizacaoPCC** fora de limite crítico.
*   Ação corretiva sobre PCC (ajuste de processo, bloqueio de lote).
### **Lógica de Backend (conceitual)**
*   Estados de **PCC**: Ativo → Suspenso → Obsoleto.
*   Regras de validação:
    *   não permitir registo de **MonitorizacaoPCC** sem PCC ativo associado;
    *   geração automática de alerta/NC quando valor excede limite crítico.

* * *

## **2.5. Módulo Materiais & Fornecedores**
### **Objetivo**
Garantir rastreabilidade de matérias‑primas, embalagens e fornecedores, conectando receção, qualificação de fornecedor e uso em lotes de produção.
### **Entidades Principais**
*   **Fornecedor**
*   **MateriaPrima** / **MaterialEmbalagem**
*   **LoteMateriaPrima** (n.º lote fornecedor, COA, validade)
*   **InspecaoRecepcao** (resultado de inspeção na receção)
*   **AvaliacaoFornecedor** (desempenho, score de qualidade)
### **Relações**
*   **Fornecedor** fornece múltiplas **MateriaPrima**.
*   Cada **LoteMateriaPrima** está ligado a um **Fornecedor** e pode ser associado a vários **LoteProducao**.
*   **InspecaoRecepcao** referencia **LoteMateriaPrima** e pode originar NC.
### **Eventos Críticos**
*   Receção e inspeção de **LoteMateriaPrima**.
*   Bloqueio/liberação de lote de matéria‑prima.
*   Reavaliação de **Fornecedor** com base em histórico de NC.
### **Lógica de Backend (conceitual)**
*   Estados de **LoteMateriaPrima**: AguardandoInspecao → EmAnalise → Liberado → Bloqueado → Consumido.
*   Cálculo de **AvaliacaoFornecedor** baseado em:
    *   % de lotes reprovados;
    *   tempo de resposta a problemas;
    *   gravidade das NC.

* * *

## **2.6. Módulo Engenharia de Produto**
### **Objetivo**
Gerir **produto**, **receita**, **especificações** e **limites de controlo**, garantindo consistência entre o que é produzido, analisado e auditado.
### **Entidades Principais**
*   **Produto** (família, categoria, versão)
*   **Receita** (ingredientes, passos de processo, parâmetros alvo)
*   **EspecificacaoProduto** (limites físico‑químicos e microbiológicos)
*   **ParametroControle** (ligado a PCC, LIMS, MES)
### **Relações**
*   **Produto** possui uma ou mais **Receita** (versões).
*   Cada **Receita** define **ParametroControle** e referencia **EspecificacaoProduto**.
### **Eventos Críticos**
*   Criação/alteração de **Receita**.
*   Alteração de **EspecificacaoProduto** (impacto direto em LIMS/FSMS).
### **Lógica de Backend (conceitual)**
*   Versionamento de **Produto/Receita/EspecificacaoProduto** com validade temporal.
*   Propagação automática de novos limites para **PlanoAmostragem** e **PCC**.

* * *

## **2.7. Módulo Relatórios & BI**
### **Objetivo**
Fornecer visibilidade consolidada de **NC, CAPA, desempenho de fornecedores, resultados laboratoriais, OEE, PCC**, etc., em dashboards industriais.
### **Entidades Principais**
*   **CuboQualidade** (fatos: NC, CAPA, resultados ensaios)
*   **CuboProducao** (fatos: lotes, yield, paragens)
*   **CuboSegurancaAlimentar** (fatos: PCC, BPF, checklists)
*   **RelatorioConfigurado** (definição de visão)
### **Lógica de Backend (conceitual)**
*   Pipelines de ETL/ELT que consolidam dados operacionais em estruturas analíticas (tabelas fato/dimensão) em Supabase.
*   Refresh agendado com janelas alinhadas a turnos e necessidades de auditoria.

* * *

## **2.8. Módulo IA & SPC**
### **Objetivo**
Aplicar **SPC, modelos preditivos e regras de negócio inteligentes** para antecipar desvios, NC e riscos de segurança alimentar.
### **Entidades Principais**
*   **SerieTemporalParametro** (dados contínuos de processo e PCC)
*   **ModeloSPC** (parâmetros de controlo estatístico)
*   **AlertaSPC** (pontos fora de controlo, tendências)
*   **ModeloIA** (classificação, regressão, previsão de falhas/NC)
*   **AlertaIA** (sinais preditivos)
### **Lógica de Backend (conceitual)**
*   Serviços Python consomem dados do MES/LIMS/FSMS, calculam indicadores SPC (Cp, Cpk, gráficos de controlo) e escrevem **AlertaSPC** para o QMS/FSMS.
*   Modelos de IA geram **AlertaIA** e sugerem ações preventivas (CAPA proativa).

* * *

# **3\. User Stories Industriais por Módulo (com ERD Mental por Story)**
Abaixo, 2 user stories por módulo (núcleo mínimo). Podem ser expandidas em backlog detalhado.
## **3.1. MES – Execução da Produção**
### **Story MES 1 – Abertura de lote rastreável**
Como **Supervisor de Turno**
Quero **abrir um lote de produção diretamente a partir da ordem planeada, associando linha, turno e matérias‑primas previstas**
Para **garantir rastreabilidade completa desde o início da produção e preparar a ligação automática com laboratório e FSMS**
Critérios de Aceitação:
*   Ao selecionar uma **OrdemProducao** em estado Planeada, o sistema permite criar um **LoteProducao** com:
    *   produto, quantidade planeada, linha, turno, data/hora de início prevista;
    *   associação aos **LoteMateriaPrima** reservados (quando conhecidos).
*   O **LoteProducao** é criado em estado EmExecucao e fica automaticamente associado à **LinhaProducao** e **Turno**.
*   É criado um gancho de integração com **PlanoAmostragem** (LIMS/FSMS) para aquele lote.
*   Toda ação é registada em **AuditLog** com utilizador, data/hora, IP/dispositivo.
Módulo: MES
Normas relacionadas: **ISO 9001 (planeamento e controlo operacional)**, **ISO 22000 (controlo de PCC e rastreabilidade)**
ERD Mental (conceitual):
*   Entidades:
    *   OrdemProducao
    *   LoteProducao
    *   LinhaProducao
    *   Turno
    *   LoteMateriaPrima
*   Relações:
    *   OrdemProducao gera LoteProducao.
    *   LoteProducao é produzido em LinhaProducao e Turno.
    *   LoteProducao consome múltiplos LoteMateriaPrima.
*   Eventos críticos:
    *   Criação de LoteProducao a partir de OrdemProducao.
    *   Registo em AuditLog da abertura de lote.

* * *

### **Story MES 2 – Encerramento de lote condicionado à Qualidade**
Como **Técnico de Qualidade**
Quero **bloquear a liberação automática de um lote até que todos os resultados laboratoriais e PCC associados estejam conformes**
Para **garantir que nenhuma decisão de liberação de produto acabado ignora dados de qualidade e segurança alimentar**
Critérios de Aceitação:
*   Quando o **Supervisor de Turno** encerra o **LoteProducao**, o estado fica AguardandoLiberacaoQualidade.
*   O sistema verifica:
    *   existência de todos os **ResultadoEnsaio** obrigatórios conforme **PlanoAmostragem**;
    *   situação de **MonitorizacaoPCC** (sem leituras fora de limite crítico sem NC tratada).
*   Apenas quando todas as condições estiverem conformes, o **Técnico de Qualidade** pode alterar o estado para Liberado.
*   Se houver resultados fora de especificação ou PCC crítico, o sistema:
    *   impede liberação;
    *   sugere abertura de **NaoConformidade** e **bloqueio do LoteProducao**.
Módulo: MES / QMS / FSMS / LIMS (integração)
Normas relacionadas: **ISO 22000, HACCP, ISO 9001**
ERD Mental (conceitual):
*   Entidades:
    *   LoteProducao
    *   ResultadoEnsaio
    *   MonitorizacaoPCC
    *   NaoConformidade
*   Relações:
    *   LoteProducao agrega ResultadoEnsaio e MonitorizacaoPCC.
    *   ResultadoEnsaio/MonitorizacaoPCC podem originar NaoConformidade.
*   Eventos críticos:
    *   Encerramento de LoteProducao.
    *   Decisão de liberação/bloqueio pela Qualidade.

* * *

## **3.2. LIMS – Laboratório**
### **Story LIMS 1 – Geração automática de amostras por plano de amostragem**
Como **Analista de Microbiologia**
Quero **receber automaticamente no LIMS as amostras a analisar sempre que um lote é iniciado ou concluído**
Para **reduzir esquecimentos manuais e garantir cumprimento sistemático do plano de amostragem**
Critérios de Aceitação:
*   Ao abrir um **LoteProducao**, o sistema verifica o **PlanoAmostragem** aplicável e gera as **Amostras** obrigatórias (processo, produto acabado, ambiente, etc.).
*   Cada **Amostra** vem com:
    *   tipo, produto, lote, horário alvo de recolha, testes obrigatórios.
*   O **Analista** visualiza uma fila de amostras AguardandoColeta por turno.
*   Auditor pode rastrear, para um lote qualquer, todas as amostras geradas e o seu estado.
Módulo: LIMS / MES / FSMS
Normas relacionadas: **ISO 17025, ISO 22000, HACCP**
ERD Mental (conceitual):
*   Entidades:
    *   PlanoAmostragem
    *   Amostra
    *   LoteProducao
*   Relações:
    *   PlanoAmostragem gera Amostra.
    *   Amostra referencia LoteProducao.
*   Eventos críticos:
    *   Abertura de LoteProducao.
    *   Geração automática de Amostra.

* * *

### **Story LIMS 2 – Validação de resultados com impacto em lote**
Como **Responsável de Laboratório**
Quero **validar resultados de ensaio com rastreabilidade ao lote e gerar automaticamente NC quando fora de especificação**
Para **garantir tratamento imediato de riscos e coerência entre laudos e decisões de qualidade**
Critérios de Aceitação:
*   Ao registar um **ResultadoEnsaio**, o sistema compara o valor com a **EspecificacaoProduto**.
*   Se o resultado estiver fora de especificação:
    *   o sistema obriga a classificação de criticidade;
    *   propõe abertura de **NaoConformidade** ligada ao **LoteProducao** e à **Amostra**;
    *   pode sugerir bloqueio imediato do lote.
*   A emissão de **Laudo** só é permitida se todos os resultados estiverem validados.
Módulo: LIMS / QMS / MES
Normas relacionadas: **ISO 17025, ISO 9001, ISO 22000**
ERD Mental (conceitual):
*   Entidades:
    *   ResultadoEnsaio
    *   EspecificacaoProduto
    *   NaoConformidade
    *   LoteProducao
*   Relações:
    *   ResultadoEnsaio referencia EspecificacaoProduto e LoteProducao.
    *   ResultadoEnsaio fora de especificação origina NaoConformidade.
*   Eventos críticos:
    *   Validação de ResultadoEnsaio.
    *   Geração automática de NC.

* * *

## **3.3. QMS – Gestão da Qualidade**
### **Story QMS 1 – NC automática por desvio de PCC**
Como **Responsável de Segurança Alimentar**
Quero **que o sistema abra automaticamente uma não conformidade sempre que um PCC estiver fora de limite crítico**
Para **eliminar risco de omissão de registo e garantir rastreabilidade completa de ações corretivas**
Critérios de Aceitação:
*   Quando um registo de **MonitorizacaoPCC** excede o limite crítico:
    *   é criada automaticamente uma **NaoConformidade** com origem "PCC";
    *   o **PCC** e o **LoteProducao** ficam associados à NC.
*   A NC é criada em estado Aberta e atribuída ao responsável definido no **PlanoHACCP**.
Módulo: QMS / FSMS
Normas relacionadas: **ISO 22000, HACCP**
ERD Mental (conceitual):
*   Entidades:
    *   MonitorizacaoPCC
    *   NaoConformidade
    *   PlanoHACCP
    *   LoteProducao
*   Relações:
    *   MonitorizacaoPCC referencia PlanoHACCP/PCC e LoteProducao.
    *   MonitorizacaoPCC fora de limite crítico origina NaoConformidade.
*   Eventos críticos:
    *   Registo de valor fora de limite crítico.
    *   Abertura automática de NC.

* * *

### **Story QMS 2 – Fecho de CAPA com verificação de eficácia**
Como **Auditor Interno**
Quero **ver, para cada NC, a cadeia completa de CAPA e evidências de eficácia**
Para **comprovar que os problemas não se repetem e que o sistema de gestão da qualidade é efetivo**
Critérios de Aceitação:
*   Cada **CAPA** possui:
    *   ações definidas, responsáveis, prazos, indicadores de eficácia;
    *   registos de implementação e verificação.
*   Uma **NaoConformidade** só pode ser encerrada se todas as CAPA associadas estiverem em estado Encerrada com eficácia marcada como "Satisfatória".
*   O auditor consegue extrair um relatório com linha do tempo NC → CAPA → verificação de eficácia.
Módulo: QMS
Normas relacionadas: **ISO 9001, ISO 22000**
ERD Mental (conceitual):
*   Entidades:
    *   NaoConformidade
    *   CAPA
    *   Auditoria
*   Relações:
    *   NaoConformidade possui múltiplas CAPA.
    *   Auditoria referencia NaoConformidade e CAPA.
*   Eventos críticos:
    *   Encerramento de CAPA.
    *   Encerramento de NaoConformidade.

* * *

## **3.4. FSMS – Segurança Alimentar**
### **Story FSMS 1 – Gestão centralizada de plano HACCP**
Como **Responsável de Segurança Alimentar**
Quero **configurar e manter o plano HACCP por produto e linha dentro do sistema**
Para **garantir que todos os PCC, limites e ações corretivas estão alinhados e acessíveis às equipas de chão de fábrica e auditoria**
Critérios de Aceitação:
*   O sistema permite criar um **PlanoHACCP** por unidade/produto/linha, incluindo:
    *   fluxograma de processo;
    *   PCC, limites críticos, medidas preventivas, ações corretivas.
*   Cada **PCC** é ligável a pontos de registo no MES (operadores) e a parâmetros laboratoriais.
*   O histórico de versões do PlanoHACCP é mantido e rastreável.
Módulo: FSMS / MES / LIMS
Normas relacionadas: **ISO 22000, HACCP**
ERD Mental (conceitual):
*   Entidades:
    *   PlanoHACCP
    *   PCC
    *   Produto
    *   LinhaProducao
*   Relações:
    *   PlanoHACCP referencia Produto e LinhaProducao.
    *   PlanoHACCP possui vários PCC.
*   Eventos críticos:
    *   Criação/alteração de PlanoHACCP.

* * *

### **Story FSMS 2 – Evidência de BPF em checklists**
Como **Técnico de Qualidade**
Quero **registar inspeções de BPF em checklists digitais com fotos e anexos**
Para **demonstrar em auditorias o cumprimento sistemático de pré‑requisitos de higiene e infraestruturas**
Critérios de Aceitação:
*   O sistema oferece **ChecklistBPF** configuráveis por área e frequência.
*   Cada execução de checklist guarda:
    *   respostas, fotos, comentários, responsável, data/hora.
*   NC podem ser originadas diretamente de respostas "Não Conforme".
*   Auditor consegue filtrar checklists por data, área, tipo de desvio.
Módulo: FSMS / QMS
Normas relacionadas: **ISO 22000, BPF**
ERD Mental (conceitual):
*   Entidades:
    *   ChecklistBPF
    *   ExecucaoChecklist
    *   NaoConformidade
*   Relações:
    *   ChecklistBPF possui múltiplas ExecucaoChecklist.
    *   ExecucaoChecklist pode originar NaoConformidade.
*   Eventos críticos:
    *   Execução de checklist.
    *   Abertura de NC por BPF.

* * *

## **3.5. Materiais & Fornecedores**
### **Story MAT 1 – Inspeção de receção com bloqueio de lote**
Como **Técnico de Qualidade de Receção**
Quero **registar inspeções de receção de matérias‑primas ligadas a lotes de fornecedor**
Para **decidir rapidamente sobre bloqueio/liberação e alimentar o score de fornecedor**
Critérios de Aceitação:
*   Cada **LoteMateriaPrima** tem um registo de **InspecaoRecepcao** com campos obrigatórios (documentos, integridade de embalagem, condições de transporte, etc.).
*   O estado do **LoteMateriaPrima** muda para Liberado ou Bloqueado após inspeção.
*   Reprovações alimentam o histórico de **AvaliacaoFornecedor**.
Módulo: Materiais & Fornecedores / QMS
Normas relacionadas: **ISO 9001, ISO 22000, BPF**
ERD Mental (conceitual):
*   Entidades:
    *   LoteMateriaPrima
    *   InspecaoRecepcao
    *   Fornecedor
    *   AvaliacaoFornecedor
*   Relações:
    *   Fornecedor possui múltiplos LoteMateriaPrima.
    *   LoteMateriaPrima possui uma InspecaoRecepcao.
    *   InspecaoRecepcao alimenta AvaliacaoFornecedor.
*   Eventos críticos:
    *   Registo de inspeção.
    *   Decisão de liberação/bloqueio.

* * *

### **Story MAT 2 – Avaliação periódica de fornecedores**
Como **Gestor de Qualidade**
Quero **avaliar periodicamente fornecedores com base em dados reais de NC, atrasos e rejeições**
Para **decidir sobre homologação, requalificação ou descredenciamento com base objetiva**
Critérios de Aceitação:
*   O sistema calcula um **score de fornecedor** com base em:
    *   % de lotes reprovados;
    *   nº de NC graves ligadas ao fornecedor;
    *   atrasos de entrega críticos.
*   É possível classificar fornecedores (A/B/C) e anexar decisões de homologação.
Módulo: Materiais & Fornecedores / QMS
Normas relacionadas: **ISO 9001, ISO 22000**
ERD Mental (conceitual):
*   Entidades:
    *   Fornecedor
    *   LoteMateriaPrima
    *   NaoConformidade
    *   AvaliacaoFornecedor
*   Relações:
    *   LoteMateriaPrima e NaoConformidade alimentam AvaliacaoFornecedor.
*   Eventos críticos:
    *   Cálculo periódico de AvaliacaoFornecedor.

* * *

## **3.6. Engenharia de Produto**
### **Story ENG 1 – Gestão de especificações por produto**
Como **Engenheiro de Processo**
Quero **definir e versionar especificações de produto (físico‑químicas e microbiológicas) diretamente no sistema**
Para **alinhar LIMS, FSMS e Produção num único referencial de limites e requisitos**
Critérios de Aceitação:
*   Cada **Produto** possui uma ou mais **EspecificacaoProduto** com datas de validade.
*   A alteração de uma especificação gera nova versão sem perda de histórico.
*   LIMS e FSMS passam a usar automaticamente os novos limites a partir da data de vigência.
Módulo: Engenharia de Produto / LIMS / FSMS
Normas relacionadas: **ISO 9001, ISO 22000, ISO 17025**
ERD Mental (conceitual):
*   Entidades:
    *   Produto
    *   EspecificacaoProduto
    *   ParametroControle
*   Relações:
    *   Produto possui múltiplas EspecificacaoProduto.
    *   EspecificacaoProduto define ParametroControle.
*   Eventos críticos:
    *   Criação/alteração de especificação.

* * *

### **Story ENG 2 – Propagação de parâmetros de controlo para PCC e LIMS**
Como **Responsável de Segurança Alimentar**
Quero **ligar parâmetros de especificação de produto a PCC e a ensaios laboratoriais**
Para **garantir que qualquer mudança de especificação se reflete automaticamente no controlo de processo e de laboratório**
Critérios de Aceitação:
*   É possível mapear cada **ParametroControle** a:
    *   um **PCC** (no FSMS);
    *   um método/ensaio no **LIMS**.
*   Atualizações de limites em **ParametroControle** atualizam automaticamente PCC e critérios de aceitação de ensaios.
Módulo: Engenharia de Produto / FSMS / LIMS
Normas relacionadas: **ISO 22000, HACCP, ISO 17025**
ERD Mental (conceitual):
*   Entidades:
    *   ParametroControle
    *   PCC
    *   EnsaioLaboratorial
*   Relações:
    *   ParametroControle alimenta configuração de PCC e EnsaioLaboratorial.
*   Eventos críticos:
    *   Atualização de ParametroControle.

* * *

## **3.7. Relatórios & BI**
### **Story BI 1 – Painel de NC e CAPA por linha e produto**
Como **Diretor de Fábrica**
Quero **visualizar num painel único todas as NC e CAPA por linha e produto, com tendência temporal**
Para **priorizar investimentos, treinamentos e ações estruturais com base em dados**
Critérios de Aceitação:
*   Dashboard apresenta:
    *   nº de NC por linha/produto/período;
    *   estado e atraso de CAPA;
    *   tendência de reincidência.
*   Dados são atualizados automaticamente com base em QMS e MES.
Módulo: Relatórios & BI / QMS / MES
Normas relacionadas: **ISO 9001, ISO 22000**
ERD Mental (conceitual):
*   Entidades:
    *   NaoConformidade (fato)
    *   CAPA (fato)
    *   LinhaProducao (dimensão)
    *   Produto (dimensão)
*   Relações:
    *   Fatos NC/CAPA ligados a dimensões LinhaProducao, Produto, Tempo.
*   Eventos críticos:
    *   Carga periódica de cubos analíticos.

* * *

### **Story BI 2 – Relatório de desempenho de fornecedores**
Como **Gestor de Compras**
Quero **aceder a um relatório de desempenho de fornecedores baseado em dados de receção, NC e devoluções**
Para **negociar contratos e decisões de homologação com base objetiva**
Critérios de Aceitação:
*   Relatório apresenta, por fornecedor:
    *   nº de lotes recebidos, % reprovados;
    *   nº de NC graves;
    *   tendências por período.
Módulo: Relatórios & BI / Materiais & Fornecedores / QMS
Normas relacionadas: **ISO 9001**
ERD Mental (conceitual):
*   Entidades:
    *   Fornecedor (dimensão)
    *   LoteMateriaPrima (fato)
    *   NaoConformidade (fato)
*   Relações:
    *   LoteMateriaPrima e NaoConformidade ligados à dimensão Fornecedor.
*   Eventos críticos:
    *   Atualização de cubo de fornecedores.

* * *

## **3.8. IA & SPC**
### **Story IA/SPC 1 – Alerta SPC para desvio de processo**
Como **Engenheiro de Processo**
Quero **receber alertas automáticos quando parâmetros críticos de processo saem de controlo estatístico**
Para **atuar antes que ocorram NC ou paragens de linha**
Critérios de Aceitação:
*   Dados de processo relevantes alimentam um **ModeloSPC** configurado.
*   Quando o modelo detecta pontos fora de controlo ou tendências, gera um **AlertaSPC**.
*   Alerta é visível em painel e pode originar NC ou ação preventiva.
Módulo: IA & SPC / MES / QMS
Normas relacionadas: **ISO 9001 (melhoria contínua)**
ERD Mental (conceitual):
*   Entidades:
    *   SerieTemporalParametro
    *   ModeloSPC
    *   AlertaSPC
*   Relações:
    *   SerieTemporalParametro alimenta ModeloSPC.
    *   ModeloSPC gera AlertaSPC.
*   Eventos críticos:
    *   Geração de AlertaSPC.

* * *

### **Story IA/SPC 2 – Previsão de risco de NC**
Como **Responsável de Qualidade**
Quero **receber previsões de risco de NC por linha e produto com base em histórico de dados de processo, laboratório e NC**
Para **priorizar ações preventivas e auditorias internas**
Critérios de Aceitação:
*   Um **ModeloIA** consome dados históricos de MES, LIMS e QMS.
*   Para cada combinação linha/produto/período, o modelo calcula um score de risco de NC.
*   Scores altos podem disparar planos de auditoria interna ou CAPA preventiva.
Módulo: IA & SPC / MES / LIMS / QMS
Normas relacionadas: **ISO 9001 (melhoria contínua), ISO 22000**
ERD Mental (conceitual):
*   Entidades:
    *   ModeloIA
    *   AlertaIA
    *   NaoConformidade
*   Relações:
    *   ModeloIA gera AlertaIA.
    *   AlertaIA referencia probabilidade de futuras NaoConformidade.
*   Eventos críticos:
    *   Execução periódica de ModeloIA.
    *   Geração de AlertaIA.